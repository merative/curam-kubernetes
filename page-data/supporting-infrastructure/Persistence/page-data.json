{"componentChunkName":"component---src-pages-supporting-infrastructure-persistence-mdx","path":"/supporting-infrastructure/Persistence/","result":{"pageContext":{"frontmatter":{"title":"Persistence Storage","description":"Persistence Storage of the Applications Logs"},"relativePagePath":"/supporting-infrastructure/Persistence.mdx","titleType":"page","MdxNode":{"id":"3ba2f76d-f0f4-516d-bd73-1926caf8a2bf","children":[],"parent":"1032b7c0-c785-5448-9c78-f30f4bb07222","internal":{"content":"---\ntitle: Persistence Storage\ndescription: Persistence Storage of the Applications Logs\n---\n\n### What is Persistence Storage?\n\nIn Kubernetes, any data stored within the application pods is typically lost when the container terminates.\n\nPersistent storage addresses this challenge by providing the ability to store and access data in a durable and consistent manner across container deployments, even when the containers are rescheduled, restarted, or replaced.\n\nUsing persistent storage, the applications running in Kubernetes clusters can retain data beyond the lifespan of individual containers.\nThis ensures that information such as files, logs, and generated content, remains intact and accessible even if containers are destroyed or recreated.\n\nFor more information about persistent storage, see [Persistent storage for Kubernetes](https://aws.amazon.com/blogs/storage/persistent-storage-for-kubernetes/).\n\n### Using Persistent Storage in Cúram\n\nThere is a wide range of choices provided by various Cloud providers for utilising persistent storage in order to store and access information using Cúram on Kubernetes.\nThe common types of storage are Block Storage which controls data on devices, [File Storage](https://docs.oracle.com/en-us/iaas/Content/File/Concepts/filestorageoverview.htm) which is using the NFS and SMB protocols, or [Object Storage](https://docs.oracle.com/en-us/iaas/Content/Object/Concepts/objectstorageoverview.htm) for unstructured data such as COS, AWS S3, and Azure Blob.\n\nChoosing the appropriate method for enabling persistent storage in the Cúram application on Kubernetes depends on number of factors:\n\n* the availability of services offered by the Cloud provider\n* the version of the Kubernetes or OpenShift cluster\n* the compatibility and support provided by the selected platform.\n\nTypically, the primary options for achieving persistence are File Storage and Object Storage.\n\n#### File Storage\n\nFile Storage is a storage method that stores data in a hierarchical structure, within folders as a single unit of information.\nIt is widely accessible and offers relatively fast performance. File storage is typically leveraging protocols such as Network File System (NFS) and Server Message Block (SMB).\nSome notable implementations of File Storage include IBM Cloud File Storage (CFS), Amazon Elastic File System (EFS), and Azure File Service (AFS).\n\n#### Object Storage\n\nObject Storage enables the storage of vast amounts of data in a straightforward and cost-effective manner.\nIn Azure, you can utilize Azure Blob Storage to access object storage, which is configured within a Premium Storage Account.\nWhile Azure Blob Storage shares similarities with Cloud Object Storage (COS) and Amazon S3 (S3), it does not offer support for the S3FS protocol interface.\n\n### Usage\n\nThe following sample configurations are examples showing how to create Persistence Volume dynamically during the deployment of Cúram on Kubernetes.\n\n<Tabs>\n\n<Tab label=\"Azure File Service\">\n<Row>\n<Column>\n\nTo archive data persistently through [Azure File Service Storage](https://learn.microsoft.com/en-us/azure/aks/azure-files-csi), prepare the following prerequisites in the Kubernetes cluster and in your Azure subscription:\n\n* On Azure, create a storage account of type Premium\n* Within the storage account, create a Azure File Service instance, and take note of the name as \"AccountName\"\n* In the Azure File Service instance, in the Access Keys section, create a new key, and take note of the name as \"AccountKey\" (alternatively create a SAS token)\n* Navigate to the Azure File Service instance, create a File Share, select the protocol as 'SMB', and take note of the name as \"file-share-smb\"\n* Encode the values of \"AccountName\" and \"AccountKey\" (or SAS token) in Base64 and add the following section to your override-values.yaml file with the correct values inputted\n* Enter the properties as illustrated in the example below\n\n```yaml path=override-values.yaml\n---\nglobal:\n  apps:\n    common:\n      persistence:\n        ## Persistence volume to store data (such as non-log files)\n        enabled: false\n        ## If enabled, connects to a persistence storage service\n        credentials:\n          azurestorageaccountname: \"AccountName (encoded in Base64)\"\n          azurestorageaccountkey: \"AccountKey (encoded in Base64)\"\n        storageClassName: \"azureblob-fuse-premium\"\n        storageCapacity: \"10Gi\"\n        properties:\n          azureFile:\n            secretName: \"spm-persistence-secret\"\n            shareName: \"file-share-smb\"\n            readOnly: false\n        mountPoint: '/tmp/persistence'\n        jmxstats:\n          ## Parameters of the JMX Stats to be persisted on the PVC\n          # The property timerPeriod sets the value curam.jmx.output_statistics_timer_period in milliseconds\n          enabled: false\n          timerPeriod: 60000\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Azure Blob Storage\">\n<Row>\n<Column>\n\nTo archive data persistently through [Azure Blob Storage](https://learn.microsoft.com/en-us/azure/aks/azure-blob-csi?tabs=Blobfuse), prepare the following prerequisites in the Kubernetes cluster and in your Azure subscription:\n\n* On Azure, create a storage account of type Premium\n* Within the storage account, create a Azure Blob Storage instance, and take note of the name as \"AccountName\"\n* In the Azure Blob Storage instance, in the Access Keys section, create a new key, and take note of the name as \"AccountKey\" (alternatively create a SAS token)\n* Navigate to the Azure Blob Storage instance, create a container, and take note of the name as \"blob-container\"\n* Encode the values of \"AccountName\" and \"AccountKey\" (or SAS token) in Base64 and add the following section to your override-values.yaml file with the correct values inputted\n* Enter the properties as illustrated in the example below\n\n<InlineNotification kind='warning'>\n\n**NOTE** Azure Blob Storage is not supported on the Openshift platform\n\n</InlineNotification>\n\n</Column>\n</Row>\n<Row>\n<Column>\n\n```yaml path=override-values.yaml\n---\nglobal:\n  apps:\n    common:\n      persistence:\n        ## Persistence volume to store data (such as non-log files)\n        enabled: false\n        ## If enabled, creates a PV and PVC to connect to Azure Blob Storage container\n        credentials:\n          azurestorageaccountname: \"AccountName (encoded in Base64)\"\n          azurestorageaccountkey: \"AccountKey (encoded in Base64)\"\n        storageClassName: \"azureblob-fuse-premium\"\n        storageCapacity: \"10Gi\"\n        storageAccessModes: \"ReadWriteMany\"\n        properties:\n          persistentVolumeReclaimPolicy: 'Delete'\n          storageClassName: 'azureblob-fuse-premium'\n          mountOptions:\n            - -o allow_other\n            - --file-cache-timeout-in-seconds=120\n          csi:\n            driver: 'blob.csi.azure.com'\n            readOnly: false\n            volumeHandle: \"pv-handle-unique-id\"\n            volumeAttributes:\n              containerName: \"blob-container\"\n              isHnsEnabled: \"true\"\n              protocol: fuse2\n            nodeStageSecretRef:\n              name: \"spm-persistence-secret\"\n              namespace: \"my-namespace\"\n        jmxstats:\n          ## Parameters of the JMX Stats to be persisted on the PVC\n          # The property timerPeriod sets the value curam.jmx.output_statistics_timer_period in milliseconds\n          enabled: false\n          timerPeriod: 60000\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Elastic File System\">\n<Row>\n<Column>\n\nTo archive data persistently through [Amazon Elastic File System](https://docs.aws.amazon.com/efs/latest/ug/whatisefs.html), prepare the following prerequisites in the Kubernetes cluster and in your AWS subscription:\n\n* Within the EKS Cluster add the addon for EFS\n* On Amazon, create an Elastic File System and take note of the name as \"File system ID\".\n* Within the Elastic File System, create an Access point, and take note of the name as \"Access point ID\"\n* For the Access point set the following;\n  * Root directory path to \"/tmp\"\n  * POSIX; user User ID \"1001\"\n  * POSIX; user Group ID \"0\"\n  * Root directory creation permissions; Owner user ID \"1001\"\n  * Root directory creation permissions; Owner group ID \"0\n\"\n  * Root directory creation permissions; Permissions \"755\"\n\n```yaml path=override-values.yaml\n---\nglobal:\n  apps:\n    common:\n      persistence:\n        ## Persistence volume to store data (such as non-log files)\n        enabled: false\n        ## If enabled, connects to a persistence storage service\n        credentials:\n        storageClassName: \"efs-sc\",\n        storageCapacity: \"10Gi\"\n        volumeMode: \"Filesystem\",\n        properties:\n          persistentVolumeReclaimPolicy: \"Delete\",\n          mountOptions: [\n          ],\n          csi: [\n            driver: \"efs.csi.aws.com\",\n            ## Values from EFS that has been setup\n            volumeHandle: \"File system ID::Access point ID\",\n          ]\n        mountPoint: '/tmp/persistence'\n        jmxstats:\n          ## Parameters of the JMX Stats to be persisted on the PVC\n          # The property timerPeriod sets the value curam.jmx.output_statistics_timer_period in milliseconds\n          enabled: false\n          timerPeriod: 60000\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n","type":"Mdx","contentDigest":"fbe057e41d527ac9316936adf061dc68","owner":"gatsby-plugin-mdx","counter":194},"frontmatter":{"title":"Persistence Storage","description":"Persistence Storage of the Applications Logs"},"exports":{},"rawBody":"---\ntitle: Persistence Storage\ndescription: Persistence Storage of the Applications Logs\n---\n\n### What is Persistence Storage?\n\nIn Kubernetes, any data stored within the application pods is typically lost when the container terminates.\n\nPersistent storage addresses this challenge by providing the ability to store and access data in a durable and consistent manner across container deployments, even when the containers are rescheduled, restarted, or replaced.\n\nUsing persistent storage, the applications running in Kubernetes clusters can retain data beyond the lifespan of individual containers.\nThis ensures that information such as files, logs, and generated content, remains intact and accessible even if containers are destroyed or recreated.\n\nFor more information about persistent storage, see [Persistent storage for Kubernetes](https://aws.amazon.com/blogs/storage/persistent-storage-for-kubernetes/).\n\n### Using Persistent Storage in Cúram\n\nThere is a wide range of choices provided by various Cloud providers for utilising persistent storage in order to store and access information using Cúram on Kubernetes.\nThe common types of storage are Block Storage which controls data on devices, [File Storage](https://docs.oracle.com/en-us/iaas/Content/File/Concepts/filestorageoverview.htm) which is using the NFS and SMB protocols, or [Object Storage](https://docs.oracle.com/en-us/iaas/Content/Object/Concepts/objectstorageoverview.htm) for unstructured data such as COS, AWS S3, and Azure Blob.\n\nChoosing the appropriate method for enabling persistent storage in the Cúram application on Kubernetes depends on number of factors:\n\n* the availability of services offered by the Cloud provider\n* the version of the Kubernetes or OpenShift cluster\n* the compatibility and support provided by the selected platform.\n\nTypically, the primary options for achieving persistence are File Storage and Object Storage.\n\n#### File Storage\n\nFile Storage is a storage method that stores data in a hierarchical structure, within folders as a single unit of information.\nIt is widely accessible and offers relatively fast performance. File storage is typically leveraging protocols such as Network File System (NFS) and Server Message Block (SMB).\nSome notable implementations of File Storage include IBM Cloud File Storage (CFS), Amazon Elastic File System (EFS), and Azure File Service (AFS).\n\n#### Object Storage\n\nObject Storage enables the storage of vast amounts of data in a straightforward and cost-effective manner.\nIn Azure, you can utilize Azure Blob Storage to access object storage, which is configured within a Premium Storage Account.\nWhile Azure Blob Storage shares similarities with Cloud Object Storage (COS) and Amazon S3 (S3), it does not offer support for the S3FS protocol interface.\n\n### Usage\n\nThe following sample configurations are examples showing how to create Persistence Volume dynamically during the deployment of Cúram on Kubernetes.\n\n<Tabs>\n\n<Tab label=\"Azure File Service\">\n<Row>\n<Column>\n\nTo archive data persistently through [Azure File Service Storage](https://learn.microsoft.com/en-us/azure/aks/azure-files-csi), prepare the following prerequisites in the Kubernetes cluster and in your Azure subscription:\n\n* On Azure, create a storage account of type Premium\n* Within the storage account, create a Azure File Service instance, and take note of the name as \"AccountName\"\n* In the Azure File Service instance, in the Access Keys section, create a new key, and take note of the name as \"AccountKey\" (alternatively create a SAS token)\n* Navigate to the Azure File Service instance, create a File Share, select the protocol as 'SMB', and take note of the name as \"file-share-smb\"\n* Encode the values of \"AccountName\" and \"AccountKey\" (or SAS token) in Base64 and add the following section to your override-values.yaml file with the correct values inputted\n* Enter the properties as illustrated in the example below\n\n```yaml path=override-values.yaml\n---\nglobal:\n  apps:\n    common:\n      persistence:\n        ## Persistence volume to store data (such as non-log files)\n        enabled: false\n        ## If enabled, connects to a persistence storage service\n        credentials:\n          azurestorageaccountname: \"AccountName (encoded in Base64)\"\n          azurestorageaccountkey: \"AccountKey (encoded in Base64)\"\n        storageClassName: \"azureblob-fuse-premium\"\n        storageCapacity: \"10Gi\"\n        properties:\n          azureFile:\n            secretName: \"spm-persistence-secret\"\n            shareName: \"file-share-smb\"\n            readOnly: false\n        mountPoint: '/tmp/persistence'\n        jmxstats:\n          ## Parameters of the JMX Stats to be persisted on the PVC\n          # The property timerPeriod sets the value curam.jmx.output_statistics_timer_period in milliseconds\n          enabled: false\n          timerPeriod: 60000\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Azure Blob Storage\">\n<Row>\n<Column>\n\nTo archive data persistently through [Azure Blob Storage](https://learn.microsoft.com/en-us/azure/aks/azure-blob-csi?tabs=Blobfuse), prepare the following prerequisites in the Kubernetes cluster and in your Azure subscription:\n\n* On Azure, create a storage account of type Premium\n* Within the storage account, create a Azure Blob Storage instance, and take note of the name as \"AccountName\"\n* In the Azure Blob Storage instance, in the Access Keys section, create a new key, and take note of the name as \"AccountKey\" (alternatively create a SAS token)\n* Navigate to the Azure Blob Storage instance, create a container, and take note of the name as \"blob-container\"\n* Encode the values of \"AccountName\" and \"AccountKey\" (or SAS token) in Base64 and add the following section to your override-values.yaml file with the correct values inputted\n* Enter the properties as illustrated in the example below\n\n<InlineNotification kind='warning'>\n\n**NOTE** Azure Blob Storage is not supported on the Openshift platform\n\n</InlineNotification>\n\n</Column>\n</Row>\n<Row>\n<Column>\n\n```yaml path=override-values.yaml\n---\nglobal:\n  apps:\n    common:\n      persistence:\n        ## Persistence volume to store data (such as non-log files)\n        enabled: false\n        ## If enabled, creates a PV and PVC to connect to Azure Blob Storage container\n        credentials:\n          azurestorageaccountname: \"AccountName (encoded in Base64)\"\n          azurestorageaccountkey: \"AccountKey (encoded in Base64)\"\n        storageClassName: \"azureblob-fuse-premium\"\n        storageCapacity: \"10Gi\"\n        storageAccessModes: \"ReadWriteMany\"\n        properties:\n          persistentVolumeReclaimPolicy: 'Delete'\n          storageClassName: 'azureblob-fuse-premium'\n          mountOptions:\n            - -o allow_other\n            - --file-cache-timeout-in-seconds=120\n          csi:\n            driver: 'blob.csi.azure.com'\n            readOnly: false\n            volumeHandle: \"pv-handle-unique-id\"\n            volumeAttributes:\n              containerName: \"blob-container\"\n              isHnsEnabled: \"true\"\n              protocol: fuse2\n            nodeStageSecretRef:\n              name: \"spm-persistence-secret\"\n              namespace: \"my-namespace\"\n        jmxstats:\n          ## Parameters of the JMX Stats to be persisted on the PVC\n          # The property timerPeriod sets the value curam.jmx.output_statistics_timer_period in milliseconds\n          enabled: false\n          timerPeriod: 60000\n```\n\n</Column>\n</Row>\n</Tab>\n\n<Tab label=\"Elastic File System\">\n<Row>\n<Column>\n\nTo archive data persistently through [Amazon Elastic File System](https://docs.aws.amazon.com/efs/latest/ug/whatisefs.html), prepare the following prerequisites in the Kubernetes cluster and in your AWS subscription:\n\n* Within the EKS Cluster add the addon for EFS\n* On Amazon, create an Elastic File System and take note of the name as \"File system ID\".\n* Within the Elastic File System, create an Access point, and take note of the name as \"Access point ID\"\n* For the Access point set the following;\n  * Root directory path to \"/tmp\"\n  * POSIX; user User ID \"1001\"\n  * POSIX; user Group ID \"0\"\n  * Root directory creation permissions; Owner user ID \"1001\"\n  * Root directory creation permissions; Owner group ID \"0\n\"\n  * Root directory creation permissions; Permissions \"755\"\n\n```yaml path=override-values.yaml\n---\nglobal:\n  apps:\n    common:\n      persistence:\n        ## Persistence volume to store data (such as non-log files)\n        enabled: false\n        ## If enabled, connects to a persistence storage service\n        credentials:\n        storageClassName: \"efs-sc\",\n        storageCapacity: \"10Gi\"\n        volumeMode: \"Filesystem\",\n        properties:\n          persistentVolumeReclaimPolicy: \"Delete\",\n          mountOptions: [\n          ],\n          csi: [\n            driver: \"efs.csi.aws.com\",\n            ## Values from EFS that has been setup\n            volumeHandle: \"File system ID::Access point ID\",\n          ]\n        mountPoint: '/tmp/persistence'\n        jmxstats:\n          ## Parameters of the JMX Stats to be persisted on the PVC\n          # The property timerPeriod sets the value curam.jmx.output_statistics_timer_period in milliseconds\n          enabled: false\n          timerPeriod: 60000\n```\n\n</Column>\n</Row>\n</Tab>\n\n</Tabs>\n","fileAbsolutePath":"/home/runner/work/curam-kubernetes/curam-kubernetes/src/pages/supporting-infrastructure/Persistence.mdx"}}},"staticQueryHashes":["1364590287","137577622","2102389209","2456312558","2746626797","3018647132","3037994772","56986546","768070550"]}